<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HoopMatch Admin</title>
<style>
body { font-family: Arial; background:#0f172a; color:#e5e7eb; padding:20px; }
h1 { color:#38bdf8; text-align:center; }
table { width:100%; border-collapse:collapse; margin-top:20px; }
th, td { border:1px solid #1e293b; padding:12px; text-align:left; }
th { background:#020617; cursor:pointer; }
input[type="number"], select { border-radius:5px; border:none; padding:5px; }
.status { padding:3px 8px; border-radius:5px; color:#fff; font-weight:bold; }
.Open { background:#38bdf8; }
.Full { background:#16a34a; }
.Completed { background:#facc15; color:#000; }

button {
  padding:6px 10px;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
.delete {
  background:#dc2626;
  color:#fff;
}
</style>

<nav>
  <a href="index.html">
    <button>Back</button>
  </a>
</nav>

<h1>üèÄ HoopMatch Admin Dashboard</h1>

<table id="adminTable">
<thead>
<tr>
  <th onclick="sortTable(0)">Players</th>
  <th onclick="sortTable(1)">Game Type</th>
  <th onclick="sortTable(2)">Barangay</th>
  <th onclick="sortTable(3)">Time Slot</th>
  <th>Status</th>
  <th>Rating</th>
  <th>Feedback</th>
  <th>Actions</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
let allMatches = JSON.parse(localStorage.getItem("allMatches")) || [];

function renderTable() {
  const tbody = document.querySelector("#adminTable tbody");
  tbody.innerHTML = "";

  allMatches.forEach((m, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${m.players.join(", ")}</td>
      <td>${m.gameType}</td>
      <td>${m.barangay}</td>
      <td>${m.time}</td>
      <td>
        <select onchange="updateStatus(${i}, this.value)">
          <option value="Open" ${m.status=="Open"?"selected":""}>Open</option>
          <option value="Full" ${m.status=="Full"?"selected":""}>Full</option>
          <option value="Completed" ${m.status=="Completed"?"selected":""}>Completed</option>
        </select>
      </td>
      <td>
        <input type="number" min="1" max="5"
          value="${m.rating || ''}"
          onchange="updateRating(${i}, this.value)">
      </td>
      <td contenteditable="true"
          onblur="updateFeedback(${i}, this.innerText)">
          ${m.feedback || ''}
      </td>
      <td>
        <button class="delete" onclick="deleteMatch(${i})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function updateStatus(index, value) {
  allMatches[index].status = value;
  save();
  renderTable();
}

function updateRating(index, value) {
  allMatches[index].rating = value;
  save();
}

function updateFeedback(index, value) {
  allMatches[index].feedback = value;
  save();
}

function deleteMatch(index) {
  if (confirm("Are you sure you want to delete this match?")) {
    allMatches.splice(index, 1);
    save();
    renderTable();
  }
}

function save() {
  localStorage.setItem("allMatches", JSON.stringify(allMatches));
}

// Sorting
function sortTable(col) {
  allMatches.sort((a,b) => {
    let v1 = [a.players.join(", "), a.gameType, a.barangay, a.time][col];
    let v2 = [b.players.join(", "), b.gameType, b.barangay, b.time][col];
    return v1.localeCompare(v2);
  });
  renderTable();
}

renderTable();
</script>
</body>
</html>
